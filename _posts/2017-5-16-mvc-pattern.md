---
layout: post
title: "MVC pattern 개념"
description: "MVC pattern에 대해 알아보자."
tags:
  - "pattern"
  - "javascript"
comments: true
share: true
date: 2017-5-16
---

# MVC란

MVC는 데이터(model), 표현 계층(view), 사용자 상호작용 계층(controller) 세부분으로 분리하는 디자인 패턴이다. MVC는 다음과 같은 순서로 `event`를 처리한다.

	1. 사용자가 애플리케이션과 상호작용한다.
	2. 컨트롤러의 이벤트 핸들러가 실행된다.
	3. 컨트롤러는 모델에게 데이터를 요청하고 그 결과를 뷰로 전달한다.
	4. 뷰는 데이터를 사용자에게 표시한다.

MVC의 핵심은 역할을 담당하는 각각의 MVC 컴포넌트가 의존성을 갖지 않고, 서로 분리되어 있도록 코드 영역을 명확하게 구분하는 것이다. 이렇게 하면, 각 컴포넌트를 독립적으로 개발하고, 테스트하고, 유지보수 할 수 있다.

## Model

데이터 오브젝트를 저장하는 창고다. 예를 들어 사용자 목록, 각 사용자의 속성 값, 모델과 관련한 로직 등을 포함하는 User라는 사용자 모델을 만들 수 있다.

## Controller

뷰와 모델의 존재를 알고 있는 유일한 컴포넌트다. 따라서
예를 들어, 컨트롤러는 뷰에서 이벤트와 입력을 수신해 처리(보통 이 과정에서 Model을 활용)한 다음, 뷰를 갱신해 결과를 반영한다. 컨트롤러는 페이지 로드시 form 제출 및 버튼 클릭등을 검출하는 이벤트 리스너를 추가한다. 사용자가 애플리케이션과 상호 작용하면 컨트롤러 내부의 이벤트가 행동을 개시한다.

> SPA
과거에는 stateless를 극복하기 위해 서버가 세션 쿠키로 상태를 저장 관리했다.
사용자가 다른 페이지를 요청시, 쿠키만 저장하고 기존 페이지의 상태는 잃어버렸다. 하지만 **JS application은 단일 페이지에서 실행되므로 클라이언트 메모리에 상태를 저장할 수 있다.** 이렇게 하게 되면 인터페이스의 반응속도가 무척 빨라진다. 왜냐하면 서버에서 응답을 기다릴 필요 없이, 클라이언트에 상태가 저장되어 있으므로 다음 페이지 로드를 기다릴 필요가 없어진다. 그렇다면 그 상태값은 어디에 저장해야 하는가..? MVC구조를 이용시 애플리케이션의 컨트롤러에 상태를 저장했다..

## View

뷰 계층을 통해 애플리케이션과 상호작용할 수 있다. 템플릿(html, css, js)에서 사용하는 간단한 조건문 이외에는 어떤 로직도 뷰에 포함하지 말아야 한다.
뷰에 로직을 추가하면 재앙을 초래하는 가장 확실한 방법이다.

## 템플릿 엔진

html 코드 partial를 동적으로 추가시 이용하는 방법 중 하나다. 유지보수를 높이기 위해 순수 js 파일로부터 html을 따로 분리한다. 기본적인 원리는 `{{}}`와 같은 태그를 html에 삽입하여 동적으로 변경되는 data를 javascript로 컨트롤한다.

## Data Flow

애플리케이션 실행시 Controller가 생성된다. Controller는 model과 view를 연결하기 위해 인스턴스를 프로퍼티로 갖는다. 동시에, 이벤트를 받기 위해 View와 바인딩된다. event발생시 바인딩된 컨트롤러의 콜백함수가 실행된다. 컨트롤러는 모델에게 데이터 관련 작업을 맡기고, 콜백으로 전달된 view 함수를 call하는 역할을 한다. 이 구조를 콜백구조라고 한다. 

## Summary

model
- 데이터 오브젝트를 저장
- 모델과 관련한 로직

controller
- 유일하게 뷰와 모델의 존재를 안다
- 뷰에서 이벤트와 입력을 수신해 처리한다.

view
- 뷰 계층을 통해 애플리케이션과 상호작용
- 뷰에 간단한 조건문 외에는 어떤 로직도 추가하면 안된다.

*왜 사용할까?*

Controller를 통해 Model과 View의 의존성을 줄임으로써 코드 영역을 확실하게 구분하다. 이로 인해, 개발 및 테스트 유지보수를 좀 더 용이하게 할 수 있다.
